\chapter{Serie di Fourier}
\section{Serie di Fourier nel continuo}
Le serie di Fourier si basano sulle \textbf{funzioni perioche}, ovvero funzioni che
si ripetono ad intervalli regolari.
\begin{definizione}[\textbf{Funzione periodica}]
    Una funzione $f:\mathbb{R}\to \mathbb{R}$ si dice \textbf{periodica} se
    $\forall x\in \mathbb{R}, \exists T \in \mathbb{R}$ tale che:
    \begin{equation}
        f(x+n \cdot T) = f(x) \quad \forall n \in \mathbb{Z} \text{ e } \forall x \in \mathbb{R}
    \end{equation}
\end{definizione}
\begin{proposizione}
    Se una funzione periodica di periodo $p$ è notata in un generico intervallo
    di ampiezza $p$ allora è nota ovunque.
\end{proposizione}
Il risultato precedente sarà estremamente utile. Infatti, ci permette di ricondurre
lo studio/analisi di una funzione periodica di periodo $p$ solamente nell'intervallo
$[0, p]$.
\begin{proposizione}
    L'integrale su un intervallo di ampiezza $p$ di una funzione periodica $f$
    di periodo $p$ non dipende dagli estremi di integrazione.
    \begin{equation}
        \int_{a}^{a + p}f(t)dt = \int_{b}^{b + p}f(t)dt \quad \forall a,b
    \end{equation}
    \begin{proof}
        Significa dimostrare la seguente uguaglianza:
        \begin{equation*}
            \int_{a}^{a + p}f(t)dt = \int_{0}^{p}f(t)dt
        \end{equation*}
        Per le proprietà degli integrali sappiamo che:
        \begin{equation*}
            \int_{a}^{a+p}f(t)dt =  \int_{a}^{p}f(t)dt + \int_{p}^{a+p}f(t)dt =
            \int_{a}^{0}f(t)dt +\int_{0}^{p}f(t)dt+ \int_{p}^{a+p}f(t)dt
        \end{equation*}
        Utilizzando il metodo di sostituzione, introduciamo $s = t - p$, di conseguenza
        $t= p \iff s=0$ e $t = p + a \iff s = a$. Per concludere la sostituzione
        dobbiamo aggiornare i differenziali e gli estremi di integrazione.
        Per i differenziali avremo $ds = dt$ perché $\frac{\partial s}{\partial s} = 1$
        e $\frac{\partial t-p}{\partial t} = 1$.

        Quindi gli integrali diventano
        \begin{equation*}
            \int_{a}^{0}f(t)dt +\int_{0}^{p}f(t)dt+ \int_{p}^{a+p}f(t)dt =
            \int_{a}^{0}f(t)dt +\int_{0}^{p}f(t)dt+ \int_{0}^{a}f(s)ds =
        \end{equation*}

        Ma essendo $f$ periodica di periodo $p$, sapendo che $s = t + p$ e $p$ è
        il periodo allora $f(s) = f(t)$, quindi $\int_{0}^{a}f(s)ds = \int_{0}^{a}f(t)dt$,
        perciò:
        \begin{equation*}
            \begin{aligned}
                \int_{a}^{0}f(t)dt + \int_{0}^{p}f(t)dt + \int_{0}^{a}f(s)ds =
                \int_{a}^{0}f(t)dt + \int_{0}^{p}f(t)dt + \int_{0}^{a}f(t)dt = \\
                -\int_{0}^{a}f(t)dt + \int_{0}^{a}f(t)dt + \int_{0}^{p}f(t)dt =
                \int_{0}^{p}f(t)dt
            \end{aligned}
        \end{equation*}
    \end{proof}
\end{proposizione}
\begin{nota}
    Nei computer, la rappresentazione di un integrale viene approssimata nel
    seguente modo:
    \begin{equation*}
        \int_{0}^{p}f(t)dt \approx \sum_{i=1}^{x_n}\omega_i f(t_i)
    \end{equation*}
\end{nota}
Il nostro obiettivo è quello di modificare una funzione periodica in modo da
rendere più gestibile la periodicità. Consideriamo una funzione periodica di
di periodo $t$ e la vogliamo trasformare in una funzione periodica di un generico
periodo $p$.

Per ottenere questo risultato possiamo modificare l'argomento della funzione
periodica nel seguente modo:
\begin{equation}
    f(t) = f\left(\frac{t}{p}\right)
\end{equation}
Così facendo, se $p < t$ allora stiamo accorciando il periodo della funzione. Al
contrario, se $p > t$ stiamo allungando il periodo della funzione.
\begin{proof}
    \textbf{NON SONO CONVINTO SIA GIUSTA QUESTA DIMOSTRAZIONE, VALE PER IL SENO}
    Per dimostrarlo possiamo prendere una funzione periodica generica $f$ di
    periodo $t$ e posso testare che $f(x) = f\left( n \cdot \frac{t}{p} + x\right)$
    sia periodica di periodo $p$, ovvero che $f(x + np) = f(x) \iff
        f\left(\frac{t}{p}x + np\right) = f(\frac{t}{p}x)$.

    \begin{equation*}
        f\left(x + n \cdot p\right) = f\left(\frac{t}{p}\cdot (x + np)\right) =
        f\left(\frac{tx}{p} + \frac{tnp}{p}\right) = f\left(\frac{tx}{p} + nt\right)
        = f\left(\frac{tx}{p}\right) = f'(x)
    \end{equation*}
    perché $f$ è periodica di periodo $t$.
\end{proof}

Utilizzeremo per lo più le seguenti funzioni $\sin\left(\frac{2\pi k}{p}t\right)$
e $\cos \left(\frac{2\pi k}{p}t\right)$. Dove $k$ è un intero positivo che permette
di alterare la frequenza della funzione.
\begin{proposizione}\label{prop:integrali_sinusoidi}
    Per ogni $k \geq 1$ vale il seguente integrale:
    \begin{equation*}
        \int_{0}^{p}\sin \left(\frac{2\pi k}{p}t\right) dt =
        \int_{0}^{p}\cos \left(\frac{2\pi k}{p}t\right) dt = 0
    \end{equation*}
    \begin{proof}
        Possiamo risolvere i singoli integrali, per esempio con la sostituzione
        introduciamo la variabile $s= \frac{2\pi k}{p}t$ quindi $\frac{p}{2\pi k}ds =dt$
        allora:
        \begin{equation*}
            \int_{0}^{p}\sin \left(\frac{2\pi k}{p}t\right) dt =
            \int_{0}^{2k\pi}\sin \left(s\right)\frac{p}{2\pi k}ds =
            \frac{p}{2\pi k} \int_{0}^{2k\pi}\sin \left(s\right)ds =
            \frac{p}{2\pi k} \left[-cos(s)\right]_0^{2k\pi} = 0
        \end{equation*}
        Lo stesso ragionamento può essere applicato al coseno.
    \end{proof}
\end{proposizione}
\begin{proposizione}
    Presa una qualsiasi coppia di valori interi $l, k > 0$ vale il seguente integrale:
    \begin{equation}
        \int_{0}^{p}\sin\left(\frac{2\pi l}{p}t\right) \cdot \cos\left(\frac{2\pi k}{p}t\right) dt = 0
    \end{equation}
    \begin{proof}
        Risolviamolo con la sostituzione $s= \frac{2\pi t}{p}$ quindi $ds = \frac{p}{2\pi}dt$.
        \begin{equation*}
            \int_{0}^{p}\sin\left(\frac{2\pi l}{p}t\right)\cdot \cos\left(\frac{2\pi k}{p}t\right) dt =
            \int_{0}^{2\pi}\sin\left(ls\right)\cdot \cos\left(ks\right)\frac{p}{2\pi} ds =
            \frac{p}{2\pi}\int_{0}^{2\pi}\sin\left(ls\right)\cdot \cos\left(ks\right) ds
        \end{equation*}
        Utilizzando la relazione $\frac{1}{2}\left(\sin(\alpha +\beta) +
            \sin(\alpha-\beta)\right) = \sin\left(\alpha\right)\cos\left(\beta\right)$
        possiamo dire:
        \begin{equation*}
            \begin{aligned}
                \frac{p}{2\pi}\int_{0}^{2\pi}\sin\left(ls\right)\cdot \cos\left(ks\right) ds =
                \frac{p}{2\pi}\frac{1}{2}\int_{0}^{2\pi}\sin\left((l+k)s\right)+ \sin\left((l-k)s\right) ds= \\
                =\frac{p}{4\pi}\left(\int_{0}^{2\pi}\sin\left((l+k)s\right)ds + \int_{0}^{2\pi}\sin\left((l-k)s\right) ds\right)=0
            \end{aligned}
        \end{equation*}
        Si annullano perché coincide con l'integrale della nota precedente.
    \end{proof}
\end{proposizione}
\begin{proposizione}
    Presa una qualsiasi coppia di valori interi $l, k > 0$ vale il seguente integrale:
    \begin{equation*}
        \int_{0}^{p}\cos\left(\frac{2\pi l}{p}t\right) \cdot
        \cos\left(\frac{2\pi k}{p}t\right) dt = \begin{cases}
            \frac{p}{2} & k=l      \\
            0           & k \neq l \\
        \end{cases}
    \end{equation*}
    l'integrale tra il prodotto dei coseni con frequenza diversa allora il risultato
    è nullo.
    \begin{proof}
        Per dimostralo usiamo sempre la sostituzione $s=\frac{2\pi}{p}dt$ e $\frac{p}{2\pi}ds = dt$.
        Sostituendo otteniamo:
        \begin{equation*}
            \frac{p}{2\pi}\int_{0}^{2\pi} \cos(ks) \cdot \cos(ls) ds
        \end{equation*}
        Utilizzando un procedimento simile a quello di prima, possiamo scrivere:
        \begin{equation*}
            \frac{1}{2} (\cos(\alpha + \beta) + \cos(\alpha - \beta)) = \cos(\alpha)\cos(\beta)
        \end{equation*}
        Quindi:
        \begin{equation*}
            \frac{p}{2\pi}\int_{0}^{2\pi} \cos(ks) \cdot \cos(ls) ds =
            =\frac{p}{2\pi}\int_{0}^{2\pi} \frac{1}{2}\cos((k+l)s) +\cos((k-l)s) ds =
            \frac{p}{4\pi}\int_{0}^{2\pi}\cos((k+l)s) +\cos((k-l)s) ds
        \end{equation*}
        Per il caso $k \neq l$ allora otteniamo l'integrale della proposizione
        \ref{prop:integrali_sinusoidi} e quindi è uguale a $0$.
        Se $k = l$ allora $\int_{0}^{2\pi} \cos(2k s) ds = 0$ mentre
        $\int_{0}^{2\pi}cos(0s)ds = s|_{0}^{2\pi} = 2\pi$ il quale deve essere
        moltiplicato per $\frac{p}{4\pi}$ che era il coefficiente davanti all'integrale.

        Quindi se $k=l$ allora l'integrale vale $\frac{p}{2}$.
    \end{proof}
\end{proposizione}
Per il caso $\sin \cdot \sin$ si ottiene un risultato analogo al caso $\cos \cdot \cos$
modificando solamente la seguente relazione:
\begin{equation*}
    \frac{1}{2} (\cos(\alpha + \beta) + \cos(\alpha - \beta)) = \cos(\alpha)\cos(\beta) \to
    \frac{1}{2} (\cos(\alpha - \beta) - \cos(\alpha + \beta)) = \sin(\alpha)\sin(\beta)
\end{equation*}

La stessa dimostrazione si può effettuare per 
$$\int_{0}^{p}\sin (\frac{2\pi}{p}kt)\sin (\frac{2\pi}{p}lt)dt=\begin{cases}
    \frac{p}{2}&l=k\\
    0&altrimenti
\end{cases}$$

L'idea alla basa della serie di Fourier è quella di scrivere una generica funzione 
periodica $f:\mathbb{R}\to \mathbb{R}$ di periodo $p$ in una combinazione di $\sin$
e $\cos$.

\begin{definizione}[\textbf{Serie di Fourier}]
    Sia $f:\mathbb{R}\to \mathbb{R}$ una funzione periodica di periodo $p$.
    $$f(t) = a_0 + \sum_{k=1}^{\infty}\left[a_k\cos (\frac{2\pi}{p}kt) +\beta_k\sin(\frac{2\pi}{p}kt)\right]$$
\end{definizione}

L'uguaglianza precedente è lecita perché specifica che una funzione periodica di 
periodo $p$ può essere riscritta come combinazioni lineari di funzioni periodiche 
sempre di periodo $p$. Importante è anche la limitazione della sommatoria a $\infty$
perché significa una funzione è combinazione lineare di \textbf{tutte} le funzioni 
periodiche.

All'atto pratico la sommatoria infinita è impossibile da calcolare, quindi si approssima 
la funzione ad un $N$ molto grande.

In aggiunta si può notare che i coefficienti $a_0, a_1, \dots$ partono da $0$ mentre 
$b_1,b_2,\dots$ partono da $1$. Questo è dato dal fatto che quando $k=0$ si ha 
$$a_0\cos (\frac{2\pi}{p}0t) +\beta_0\sin(\frac{2\pi}{p}0t) = a_0\cdot 1 + b_0\cdot 0 = a_0$$ 

Per utilizzare questa approssimazione mediante la serie, dobbiamo calcolare facilmente e
velocemente i coefficineti $a_i,b_i$.

Calcoliamo per prima cosa $a_0$, per ipotesi sappiamo che la serie di Fourier vale, 
allora anche gli integrali saranno uguali.

\begin{equation*}
    \int_{0}^{p}f(t) dt=\int_{0}^{p} a_0 + \sum_{k=1}^{\infty}\left[a_k\cos (\frac{2\pi}{p}kt) +\beta_k\sin(\frac{2\pi}{p}kt)\right]dt
\end{equation*}

Applicando le proprietà degli integrali si ottiene

\begin{equation*}
    \int_{0}^{p}f(t) dt=a_0\int_{0}^{p} 1dt + \sum_{k=1}^{\infty}\left[a_k\int_{0}^{p}\cos (\frac{2\pi}{p}kt)dk +\beta_k\int_{0}^{p}\sin(\frac{2\pi}{p}kt)dt\right]
\end{equation*}

Grazie alle dimostrazioni effettuate precedentemente dove
$\int_{0}^{p}\sin \left(\frac{2\pi k}{p}t\right) dt =
\int_{0}^{p}\cos \left(\frac{2\pi k}{p}t\right) dt = 0$.
Allora tutta la sommatoria si annulla.

\begin{equation*}
    \int_{0}^{p}f(t) dt=a_0\int_{0}^{p} 1dt  = a_0p\implies a_0 = \frac{1}{p}\int_{0}^{p}f(t) dt
\end{equation*}

Questa espressione si può calcolare perché $f$ è sempre nota.

\begin{nota}
    La seguente espressione è chiamata anche media integrale nell'intervallo $[0,p]$.
    
    \begin{equation*}
        a_0 = \frac{1}{p}\int_{0}^{p}f(t) dt
    \end{equation*}
\end{nota}

Per calcolare i coefficienti $a_k$ possiamo pensare di innanzitutto passare i coefficienti
$k$ a $j$ nella sommatoria e se la serie di Fourier vale allora vale anche la seguente uguaglianza.

\begin{equation*}
    \int_{0}^{p}f(t)g(t) dt=a_0\int_{0}^{p} g(t)dt + \sum_{j=1}^{\infty}\left[a_j\int_{0}^{p}\cos (\frac{2\pi}{p}jt)g(t)dk +\beta_j\int_{0}^{p}\sin(\frac{2\pi}{p}jt)g(t)dt\right]
\end{equation*}
Dato che vogliamo calcolare $a_k$ allora consideriamo

$$g(t) = \cos (\frac{2\pi}{p}kt)$$

Otteniamo di conseguenza

\begin{equation*}
    \int_{0}^{p}f(t)\cos (\frac{2\pi}{p}kt) dt=a_0\int_{0}^{p}\cos (\frac{2\pi}{p}kt)dt + \sum_{j=1}^{\infty}\left[a_j\int_{0}^{p}\cos (\frac{2\pi}{p}jt)\cos (\frac{2\pi}{p}kt)dk +\beta_j\int_{0}^{p}\sin(\frac{2\pi}{p}jt)\cos (\frac{2\pi}{p}kt)dt\right]
\end{equation*}

Sfruttando sempre le equivalenze tra gli integrali del $\sin,\cos$ allora 
$a_0\int_{0}^{p}\cos (\frac{2\pi}{p}kt)dt = 0$ e $\beta_j\int_{0}^{p}\sin(\frac{2\pi}{p}jt)\cos (\frac{2\pi}{p}kt)dt=0$,
perciò
si ottiene

\begin{equation*}
    \int_{0}^{p}f(t)\cos (\frac{2\pi}{p}kt) dt= \sum_{j=1}^{\infty}\left[a_j\int_{0}^{p}\cos (\frac{2\pi}{p}jt)\cos (\frac{2\pi}{p}kt)dk \right]
\end{equation*}

Fissato $j=k$ allora calcoliamo $a_k$  
\begin{equation*}
    \int_{0}^{p}f(t)\cos (\frac{2\pi}{p}kt) dt= a_k\int_{0}^{p}\cos (\frac{2\pi}{p}kt)\cos (\frac{2\pi}{p}kt)dk = a_k \frac{p}{2} \iff a_k =\frac{2}{p}  \int_{0}^{p}f(t)\cos (\frac{2\pi}{p}kt) dt
\end{equation*}

Il conto di $a_k$ è indipendente dagli altri valori di $a_j$ (\textbf{non mi sembra, dammi conferma}).

Successivamente dobbiamo calcolare i coefficienti $b_k$, la metodologia è la stessa
degli $a_k$ solo che in questo caso 
$$g(t) = \sin(\frac{2\pi}{p}kt)$$ 


\begin{equation*}
    %\int_{0}^{p}f(t)\sin(\frac{2\pi}{p}kt) dt=a_0\int_{0}^{p} \sin(\frac{2\pi}{p}kt)dt + \sum_{j=1}^{\infty}\left[a_j\int_{0}^{p}\cos (\frac{2\pi}{p}jt)\sin(\frac{2\pi}{p}kt)dk +\b_j \int_{0}^{p}\sin(\frac{2\pi}{p}jt)\sin(\frac{2\pi}{p}kt)dt\right]
\end{equation*}
